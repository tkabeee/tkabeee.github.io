!function(t){var e={};function s(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},s.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=0)}([function(t,e,s){"use strict";s.r(e);class i extends Phaser.State{preload(){}create(){this.game.state.start("Preloader",!0,!1)}render(){}}class r extends Phaser.State{preload(){this.load.image("unit","assets/phaser/unit.png"),this.load.image("block","assets/phaser/block.png"),this.load.image("bullet","assets/phaser/bullet.png"),this.load.spritesheet("kaboom","assets/phaser/explosion.png",64,64,23)}create(){this.game.state.start("Build",!0,!1)}}class a{}a.numTotal=8,a.health=3;class o{}o.angle=-90,o.faceForward=!0,o.point=new Phaser.Point,o.minVelocity=-200,o.maxVelocity=320,o.currentSpeed=0,o.acceleration=6,o.deceleration=4,o.rotationAngle=4,o.fireRate=300,o.fireAsDegrees=!0,o.fireVelocity=600;class h{constructor(t){this.state={},this.sprite=t,this.sprite.game.physics.enable(this.sprite,Phaser.Physics.ARCADE),this.sprite.anchor.setTo(.5,.5),this.sprite.x=250,this.sprite.y=400;const e=new Phaser.Rectangle(0,32,32,32);this.sprite.crop(e,!1),this.sprite.body.drag.set(.2),this.sprite.body.maxVelocity.setTo(400,400),this.sprite.body.collideWorldBounds=!0,this.sprite.bringToTop(),this.sprite.angle=o.angle,this.state={faceForward:o.faceForward,point:new Phaser.Point,currentSpeed:o.currentSpeed,bulletTime:0}}goReady(){0==this.state.currentSpeed&&(this.state.faceForward=!this.state.faceForward)}decelerate(){this.state.currentSpeed<=0?this.state.currentSpeed=0:o.maxVelocity%2<this.state.currentSpeed?this.state.currentSpeed-=2*o.deceleration:this.state.currentSpeed-=o.deceleration}goFront(){this.state.faceForward?this.state.currentSpeed<o.maxVelocity?this.state.currentSpeed+=o.acceleration:this.state.currentSpeed=o.maxVelocity:(this.decelerate(),this.goReady()),this.sprite.game.physics.arcade.velocityFromAngle(this.sprite.angle,this.state.currentSpeed,this.sprite.body.velocity)}goBack(){this.state.faceForward?(this.decelerate(),this.goReady()):o.minVelocity<this.state.currentSpeed?this.state.currentSpeed-=o.deceleration:this.state.currentSpeed=o.minVelocity,this.sprite.game.physics.arcade.velocityFromAngle(this.sprite.angle,this.state.currentSpeed,this.sprite.body.velocity)}rotate(t){if(!(this.state.currentSpeed<=0)){switch(!0){case"left"==t:this.sprite.angle-=o.rotationAngle;break;case"right"==t:this.sprite.angle+=o.rotationAngle}this.sprite.game.physics.arcade.velocityFromAngle(this.sprite.angle,this.state.currentSpeed,this.sprite.body.velocity)}}rotateRight(){this.rotate("right")}rotateLeft(){this.rotate("left")}fire(t){const e=this.sprite.game.time.now;if(e<this.state.bulletTime)return;this.state.bulletTime=e+o.fireRate;const s=t.getFirstExists(!1);s&&(s.reset(this.sprite.x,this.sprite.y),s.body.velocity.rotate(0,0,this.sprite.angle,o.fireAsDegrees,o.fireVelocity))}}class n{constructor(t){this.state={},this.sprite=t,this.sprite.game.physics.enable(this.sprite,Phaser.Physics.ARCADE),this.sprite.anchor.set(.5),this.sprite.body.immovable=!0,this.sprite.body.collideWorldBounds=!0,this.sprite.body.bounce.setTo(0,0),this.state={health:a.health,alive:!0}}damage(){return this.state.health-=1,!(this.state.health>0)&&(this.state.alive=!1,this.sprite.kill(),console.log("kill!!"),!0)}}class l extends Phaser.State{constructor(){super(...arguments),this.enemies=[],this.inputKeys={}}preload(){}create(){this.world.setBounds(0,0,this.game.width,this.game.height);const t=this.game.add.sprite(0,0,"unit");this.unit=new h(t);let e=a.numTotal;for(;e>0;){const t=this.game.add.sprite(this.world.randomX,this.world.randomY,"undefined"),s=new n(t);this.enemies.push(s.sprite),e--}this.bullets=this.game.add.group(),this.bullets.enableBody=!0,this.bullets.physicsBodyType=Phaser.Physics.ARCADE,this.bullets.createMultiple(3,"bullet",0,!1),this.bullets.setAll("anchor.x",.5),this.bullets.setAll("anchor.y",.5),this.bullets.setAll("outOfBoundsKill",!0),this.bullets.setAll("checkWorldBounds",!0),this.inputKeys.cursors=this.game.input.keyboard.createCursorKeys(),this.inputKeys.spacebar=this.game.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.game.input.keyboard.addKeyCapture([Phaser.Keyboard.SPACEBAR])}update(){this.inputKeys.cursors.left.isDown&&this.unit.rotateLeft(),this.inputKeys.cursors.right.isDown&&this.unit.rotateRight(),this.inputKeys.cursors.up.isDown&&this.unit.goFront(),this.inputKeys.cursors.down.isDown&&this.unit.goBack(),this.inputKeys.spacebar.isDown&&this.unit.fire(this.bullets)}}window.onload=(()=>{new class extends Phaser.Game{constructor(t,e){super(t,e,Phaser.AUTO,"field",null),this.size={},this.state.add("Boot",i,!1),this.state.add("Preloader",r,!1),this.state.add("Build",l,!1),this.state.start("Boot")}}(window.innerWidth,window.innerHeight)})}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Jvb3QudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3ByZWxvYWRlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvY29uc3RhbnRzL2VuZW15LnRzIiwid2VicGFjazovLy8uL3NyYy9jb25zdGFudHMvcGxheWVyLnRzIiwid2VicGFjazovLy8uL3NyYy9wbGF5ZXIudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2Jsb2NrLnRzIiwid2VicGFjazovLy8uL3NyYy9idWlsZC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvYXBwLnRzIiwid2VicGFjazovLy8uL3NyYy9nYW1lLnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsInZhbHVlIiwibiIsIl9fZXNNb2R1bGUiLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJCb290IiwiUGhhc2VyIiwiU3RhdGUiLCJbb2JqZWN0IE9iamVjdF0iLCJ0aGlzIiwiZ2FtZSIsInN0YXRlIiwic3RhcnQiLCJQcmVsb2FkZXIiLCJsb2FkIiwiaW1hZ2UiLCJzcHJpdGVzaGVldCIsIkNvbnN0YW50RW5lbXkiLCJudW1Ub3RhbCIsImhlYWx0aCIsIkNvbnN0YW50UGxheWVyIiwiYW5nbGUiLCJmYWNlRm9yd2FyZCIsInBvaW50IiwiUG9pbnQiLCJtaW5WZWxvY2l0eSIsIm1heFZlbG9jaXR5IiwiY3VycmVudFNwZWVkIiwiYWNjZWxlcmF0aW9uIiwiZGVjZWxlcmF0aW9uIiwicm90YXRpb25BbmdsZSIsImZpcmVSYXRlIiwiZmlyZUFzRGVncmVlcyIsImZpcmVWZWxvY2l0eSIsInBsYXllcl9QbGF5ZXIiLCJzcHJpdGUiLCJwaHlzaWNzIiwiZW5hYmxlIiwiUGh5c2ljcyIsIkFSQ0FERSIsImFuY2hvciIsInNldFRvIiwieCIsInkiLCJjcm9wUmVjdCIsIlJlY3RhbmdsZSIsImNyb3AiLCJib2R5IiwiZHJhZyIsInNldCIsImNvbGxpZGVXb3JsZEJvdW5kcyIsImJyaW5nVG9Ub3AiLCJidWxsZXRUaW1lIiwiZGVjZWxlcmF0ZSIsImdvUmVhZHkiLCJhcmNhZGUiLCJ2ZWxvY2l0eUZyb21BbmdsZSIsInZlbG9jaXR5IiwiZGlyZWN0aW9uIiwicm90YXRlIiwiYnVsbGV0cyIsIm5vdyIsInRpbWUiLCJidWxsZXQiLCJnZXRGaXJzdEV4aXN0cyIsInJlc2V0IiwiYmxvY2tfQmxvY2siLCJpbW1vdmFibGUiLCJib3VuY2UiLCJhbGl2ZSIsImtpbGwiLCJjb25zb2xlIiwibG9nIiwiYnVpbGRfQnVpbGQiLCJlbmVtaWVzIiwiaW5wdXRLZXlzIiwid29ybGQiLCJzZXRCb3VuZHMiLCJ3aWR0aCIsImhlaWdodCIsInNwcml0ZVVuaXQiLCJhZGQiLCJ1bml0IiwiZW5lbXlDb3VudCIsInNwcml0ZUJsb2NrIiwicmFuZG9tWCIsInJhbmRvbVkiLCJibG9jayIsInB1c2giLCJncm91cCIsImVuYWJsZUJvZHkiLCJwaHlzaWNzQm9keVR5cGUiLCJjcmVhdGVNdWx0aXBsZSIsInNldEFsbCIsImN1cnNvcnMiLCJpbnB1dCIsImtleWJvYXJkIiwiY3JlYXRlQ3Vyc29yS2V5cyIsInNwYWNlYmFyIiwiYWRkS2V5IiwiS2V5Ym9hcmQiLCJTUEFDRUJBUiIsImFkZEtleUNhcHR1cmUiLCJsZWZ0IiwiaXNEb3duIiwicm90YXRlTGVmdCIsInJpZ2h0Iiwicm90YXRlUmlnaHQiLCJ1cCIsImdvRnJvbnQiLCJkb3duIiwiZ29CYWNrIiwiZmlyZSIsIndpbmRvdyIsIm9ubG9hZCIsIkdhbWUiLCJzdXBlciIsIkFVVE8i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LFNBQVNDLFVBRzFFNUYsS0FBS0MsS0FBS3FGLE1BQU1DLFNBQVNNLGVBQWVoRyxPQUFPOEYsU0FBU0MsV0FHMUQ3RixTQUVNQyxLQUFLa0UsVUFBVW1CLFFBQVFTLEtBQUtDLFFBQzlCL0YsS0FBS3lFLEtBQUt1QixhQUlSaEcsS0FBS2tFLFVBQVVtQixRQUFRWSxNQUFNRixRQUMvQi9GLEtBQUt5RSxLQUFLeUIsY0FJUmxHLEtBQUtrRSxVQUFVbUIsUUFBUWMsR0FBR0osUUFDNUIvRixLQUFLeUUsS0FBSzJCLFVBSVJwRyxLQUFLa0UsVUFBVW1CLFFBQVFnQixLQUFLTixRQUM5Qi9GLEtBQUt5RSxLQUFLNkIsU0FJUnRHLEtBQUtrRSxVQUFVdUIsU0FBU00sUUFDMUIvRixLQUFLeUUsS0FBSzhCLEtBQUt2RyxLQUFLbUQsVUN6RTFCcUQsT0FBT0MsT0FBUyxNQUNELGtCQ0dtQjVHLE9BQU82RyxLQUV2QzNHLFlBQVlzRSxFQUFlQyxHQUN6QnFDLE1BQU10QyxFQUFPQyxFQUFRekUsT0FBTytHLEtBQU0sUUFBUyxNQUZyQzVHLEtBQUE2RyxRQUlON0csS0FBS0UsTUFBTXNFLElBQUksT0FBUTVFLEdBQU0sR0FDN0JJLEtBQUtFLE1BQU1zRSxJQUFJLFlBQWFwRSxHQUFXLEdBQ3ZDSixLQUFLRSxNQUFNc0UsSUFBSSxRQUFTUixHQUFPLEdBRS9CaEUsS0FBS0UsTUFBTUMsTUFBTSxVRFpHcUcsT0FBT00sV0FBWU4sT0FBT08iLCJmaWxlIjoiZ2FtZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwge1xuIFx0XHRcdFx0Y29uZmlndXJhYmxlOiBmYWxzZSxcbiBcdFx0XHRcdGVudW1lcmFibGU6IHRydWUsXG4gXHRcdFx0XHRnZXQ6IGdldHRlclxuIFx0XHRcdH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwibGlicy9waGFzZXIvcGhhc2VyLmQudHNcIiAvPlxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCb290IGV4dGVuZHMgUGhhc2VyLlN0YXRlIHtcbiAgcHJlbG9hZCgpIHtcbiAgfVxuICBjcmVhdGUoKSB7XG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdQcmVsb2FkZXInLCB0cnVlLCBmYWxzZSlcbiAgfVxuICByZW5kZXIoKSB7XG4gICAgLy8gdGhpcy5nYW1lLmRlYnVnLmJvZHlJbmZvKHVuaXQsIDMyLCAzMik7XG4gICAgLy8gdGhpcy5nYW1lLmRlYnVnLnNwcml0ZUluZm8odW5pdCwgMzIsIDE0MCk7XG4gIH1cbn1cbiIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJsaWJzL3BoYXNlci9waGFzZXIuZC50c1wiIC8+XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFByZWxvYWRlciBleHRlbmRzIFBoYXNlci5TdGF0ZSB7XG4gIHByZWxvYWQoKSB7XG4gICAgdGhpcy5sb2FkLmltYWdlKCd1bml0JywgJ2Fzc2V0cy9waGFzZXIvdW5pdC5wbmcnKVxuICAgIHRoaXMubG9hZC5pbWFnZSgnYmxvY2snLCAnYXNzZXRzL3BoYXNlci9ibG9jay5wbmcnKVxuICAgIHRoaXMubG9hZC5pbWFnZSgnYnVsbGV0JywgJ2Fzc2V0cy9waGFzZXIvYnVsbGV0LnBuZycpXG4gICAgdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdrYWJvb20nLCAnYXNzZXRzL3BoYXNlci9leHBsb3Npb24ucG5nJywgNjQsIDY0LCAyMylcbiAgfVxuICBjcmVhdGUoKSB7XG4gICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdCdWlsZCcsIHRydWUsIGZhbHNlKVxuICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29uc3RhbnRFbmVteSB7XG4gIC8vIOe3j+aVsFxuICBwdWJsaWMgc3RhdGljIG51bVRvdGFsID0gOFxuICAvLyDjg6njgqTjg5XmlbBcbiAgcHVibGljIHN0YXRpYyBoZWFsdGggPSAzXG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDb25zdGFudFBsYXllciB7XG4gIC8vIOinkuW6plxuICBwdWJsaWMgc3RhdGljIGFuZ2xlID0gLTkwICAvLyDmraPpnaJcbiAgLy8g5pa55ZCRXG4gIHB1YmxpYyBzdGF0aWMgZmFjZUZvcndhcmQgPSB0cnVlIC8vIOWJjTp0cnVlIOW+jOOCjTpmYWxzZVxuICAvLyBQb2ludCBvYmplY3RcbiAgcHVibGljIHN0YXRpYyBwb2ludCA9IG5ldyBQaGFzZXIuUG9pbnQoKVxuICAvLyDln7rmnKzpgJ/luqZcbiAgcHVibGljIHN0YXRpYyBtaW5WZWxvY2l0eSA9IC0yMDBcbiAgcHVibGljIHN0YXRpYyBtYXhWZWxvY2l0eSA9IDMyMFxuICAvLyDnj77lnKjjga7pgJ/luqZcbiAgcHVibGljIHN0YXRpYyBjdXJyZW50U3BlZWQgPSAwXG4gIC8vIOWKoOmAn+WApFxuICBwdWJsaWMgc3RhdGljIGFjY2VsZXJhdGlvbiA9IDZcbiAgLy8g5rib6YCf5YCkXG4gIHB1YmxpYyBzdGF0aWMgZGVjZWxlcmF0aW9uID0gNFxuICAvLyDlm57ou6Lop5LluqZcbiAgcHVibGljIHN0YXRpYyByb3RhdGlvbkFuZ2xlID0gNFxuXG4gIC8vIOegsuaSg+OBrumWk+malFxuICBwdWJsaWMgc3RhdGljIGZpcmVSYXRlID0gMzAwXG4gIC8vIOegsuaSg+OBruWKoOa4m1xuICBwdWJsaWMgc3RhdGljIGZpcmVBc0RlZ3JlZXMgPSB0cnVlXG4gIC8vIOW8vuS4uOOBrumAn+W6plxuICBwdWJsaWMgc3RhdGljIGZpcmVWZWxvY2l0eSA9IDYwMFxufVxuIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cImxpYnMvcGhhc2VyL3BoYXNlci5kLnRzXCIgLz5cblxuaW1wb3J0IENvbnN0YW50UGxheWVyIGZyb20gXCIuL2NvbnN0YW50cy9wbGF5ZXJcIlxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQbGF5ZXIge1xuICBwdWJsaWMgc3ByaXRlOiBQaGFzZXIuU3ByaXRlXG4gIHByaXZhdGUgc3RhdGU6IGFueSA9IHt9XG5cbiAgY29uc3RydWN0b3Ioc3ByaXRlOiBQaGFzZXIuU3ByaXRlKSB7XG4gICAgdGhpcy5zcHJpdGUgPSBzcHJpdGVcbiAgICB0aGlzLnNwcml0ZS5nYW1lLnBoeXNpY3MuZW5hYmxlKHRoaXMuc3ByaXRlLCBQaGFzZXIuUGh5c2ljcy5BUkNBREUpXG4gICAgdGhpcy5zcHJpdGUuYW5jaG9yLnNldFRvKDAuNSwgMC41KVxuICAgIC8vIE1vdmVcbiAgICB0aGlzLnNwcml0ZS54ID0gMjUwXG4gICAgdGhpcy5zcHJpdGUueSA9IDQwMFxuICAgIC8vIENyb3BcbiAgICBjb25zdCBjcm9wUmVjdCA9IG5ldyBQaGFzZXIuUmVjdGFuZ2xlKDAsIDMyLCAzMiwgMzIpXG4gICAgdGhpcy5zcHJpdGUuY3JvcChjcm9wUmVjdCwgZmFsc2UpXG4gICAgdGhpcy5zcHJpdGUuYm9keS5kcmFnLnNldCgwLjIpXG4gICAgLy8gVGhlIG1heGltdW0gdmVsb2NpdHkgaW4gcGl4ZWxzIHBlciBzZWNvbmQgc3EuIHRoYXQgdGhlIEJvZHkgY2FuIHJlYWNoLlxuICAgIHRoaXMuc3ByaXRlLmJvZHkubWF4VmVsb2NpdHkuc2V0VG8oNDAwLCA0MDApXG4gICAgLy8gY29sbGlkZSB3b3JsZCBib3VuZHNcbiAgICB0aGlzLnNwcml0ZS5ib2R5LmNvbGxpZGVXb3JsZEJvdW5kcyA9IHRydWVcblxuICAgIC8vIEJyaW5ncyB0aGUgU3ByaXRlIHRvIHRoZSB0b3Agb2YgdGhlIGRpc3BsYXkgbGlzdCBpdCBpcyBhIGNoaWxkIG9mLlxuICAgIC8vIGh0dHA6Ly9kb2NzLnBoYXNlci5pby9QaGFzZXIuU3ByaXRlLmh0bWwjYnJpbmdUb1RvcFxuICAgIHRoaXMuc3ByaXRlLmJyaW5nVG9Ub3AoKVxuXG4gICAgdGhpcy5zcHJpdGUuYW5nbGUgPSBDb25zdGFudFBsYXllci5hbmdsZVxuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBmYWNlRm9yd2FyZDogPGJvb2xlYW4+IENvbnN0YW50UGxheWVyLmZhY2VGb3J3YXJkLFxuICAgICAgcG9pbnQ6IDxQaGFzZXIuUG9pbnQ+IG5ldyBQaGFzZXIuUG9pbnQoKSxcbiAgICAgIGN1cnJlbnRTcGVlZDogPG51bWJlcj4gQ29uc3RhbnRQbGF5ZXIuY3VycmVudFNwZWVkLFxuICAgICAgYnVsbGV0VGltZTogPG51bWJlcj4gMFxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ29SZWFkeSgpIDogdm9pZCB7XG4gICAgaWYgKHRoaXMuc3RhdGUuY3VycmVudFNwZWVkID09IDApXG4gICAge1xuICAgICAgLy8g6YCy6KGM5pa55ZCR44KS5aSJ5pu0XG4gICAgICB0aGlzLnN0YXRlLmZhY2VGb3J3YXJkID0gIXRoaXMuc3RhdGUuZmFjZUZvcndhcmRcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGRlY2VsZXJhdGUoKSA6IHZvaWQge1xuICAgIGlmICh0aGlzLnN0YXRlLmN1cnJlbnRTcGVlZCA8PSAwKVxuICAgIHtcbiAgICAgIHRoaXMuc3RhdGUuY3VycmVudFNwZWVkID0gMFxuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgaWYgKChDb25zdGFudFBsYXllci5tYXhWZWxvY2l0eSAlIDIpIDwgdGhpcy5zdGF0ZS5jdXJyZW50U3BlZWQpXG4gICAge1xuICAgICAgdGhpcy5zdGF0ZS5jdXJyZW50U3BlZWQgLT0gKENvbnN0YW50UGxheWVyLmRlY2VsZXJhdGlvbiAqIDIpXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICB0aGlzLnN0YXRlLmN1cnJlbnRTcGVlZCAtPSBDb25zdGFudFBsYXllci5kZWNlbGVyYXRpb25cbiAgfVxuXG4gIHB1YmxpYyBnb0Zyb250KCkgOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuc3RhdGUuZmFjZUZvcndhcmQpXG4gICAge1xuICAgICAgdGhpcy5kZWNlbGVyYXRlKClcbiAgICAgIHRoaXMuZ29SZWFkeSgpXG4gICAgfVxuICAgIGVsc2VcbiAgICB7XG4gICAgICBpZiAodGhpcy5zdGF0ZS5jdXJyZW50U3BlZWQgPCBDb25zdGFudFBsYXllci5tYXhWZWxvY2l0eSlcbiAgICAgIHtcbiAgICAgICAgdGhpcy5zdGF0ZS5jdXJyZW50U3BlZWQgKz0gQ29uc3RhbnRQbGF5ZXIuYWNjZWxlcmF0aW9uXG4gICAgICB9XG4gICAgICBlbHNlXG4gICAgICB7XG4gICAgICAgIHRoaXMuc3RhdGUuY3VycmVudFNwZWVkID0gQ29uc3RhbnRQbGF5ZXIubWF4VmVsb2NpdHlcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnNwcml0ZS5nYW1lLnBoeXNpY3MuYXJjYWRlLnZlbG9jaXR5RnJvbUFuZ2xlKHRoaXMuc3ByaXRlLmFuZ2xlLCB0aGlzLnN0YXRlLmN1cnJlbnRTcGVlZCwgdGhpcy5zcHJpdGUuYm9keS52ZWxvY2l0eSlcbiAgfVxuXG4gIHB1YmxpYyBnb0JhY2soKSA6IHZvaWQge1xuICAgIC8vIOa4m+mAn+WJjemAsuS4rVxuICAgIGlmICh0aGlzLnN0YXRlLmZhY2VGb3J3YXJkKVxuICAgIHtcbiAgICAgIHRoaXMuZGVjZWxlcmF0ZSgpXG4gICAgICB0aGlzLmdvUmVhZHkoKVxuICAgIH1cbiAgICBlbHNlXG4gICAge1xuICAgICAgaWYgKENvbnN0YW50UGxheWVyLm1pblZlbG9jaXR5IDwgdGhpcy5zdGF0ZS5jdXJyZW50U3BlZWQpXG4gICAgICB7XG4gICAgICAgIHRoaXMuc3RhdGUuY3VycmVudFNwZWVkIC09IENvbnN0YW50UGxheWVyLmRlY2VsZXJhdGlvblxuICAgICAgfVxuICAgICAgZWxzZVxuICAgICAge1xuICAgICAgICB0aGlzLnN0YXRlLmN1cnJlbnRTcGVlZCA9IENvbnN0YW50UGxheWVyLm1pblZlbG9jaXR5XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5zcHJpdGUuZ2FtZS5waHlzaWNzLmFyY2FkZS52ZWxvY2l0eUZyb21BbmdsZSh0aGlzLnNwcml0ZS5hbmdsZSwgdGhpcy5zdGF0ZS5jdXJyZW50U3BlZWQsIHRoaXMuc3ByaXRlLmJvZHkudmVsb2NpdHkpXG4gIH1cblxuICBwcml2YXRlIHJvdGF0ZShkaXJlY3Rpb246IHN0cmluZykgOiB2b2lkIHtcbiAgICBpZiAodGhpcy5zdGF0ZS5jdXJyZW50U3BlZWQgPD0gMClcbiAgICB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBzd2l0Y2ggKHRydWUpIHtcbiAgICAgIGNhc2UgZGlyZWN0aW9uID09ICdsZWZ0JzpcbiAgICAgICAgdGhpcy5zcHJpdGUuYW5nbGUgLT0gQ29uc3RhbnRQbGF5ZXIucm90YXRpb25BbmdsZVxuICAgICAgICBicmVha1xuICAgICAgY2FzZSBkaXJlY3Rpb24gPT0gJ3JpZ2h0JzpcbiAgICAgICAgdGhpcy5zcHJpdGUuYW5nbGUgKz0gQ29uc3RhbnRQbGF5ZXIucm90YXRpb25BbmdsZVxuICAgICAgICBicmVha1xuICAgIH1cblxuICAgIHRoaXMuc3ByaXRlLmdhbWUucGh5c2ljcy5hcmNhZGUudmVsb2NpdHlGcm9tQW5nbGUodGhpcy5zcHJpdGUuYW5nbGUsIHRoaXMuc3RhdGUuY3VycmVudFNwZWVkLCB0aGlzLnNwcml0ZS5ib2R5LnZlbG9jaXR5KVxuICB9XG5cbiAgcHVibGljIHJvdGF0ZVJpZ2h0KCkgOiB2b2lkIHtcbiAgICB0aGlzLnJvdGF0ZSgncmlnaHQnKVxuICB9XG5cbiAgcHVibGljIHJvdGF0ZUxlZnQoKSA6IHZvaWQge1xuICAgIHRoaXMucm90YXRlKCdsZWZ0JylcbiAgfVxuXG4gIHB1YmxpYyBmaXJlKGJ1bGxldHM6IFBoYXNlci5Hcm91cCkgOiB2b2lkIHtcbiAgICBjb25zdCBub3cgPSB0aGlzLnNwcml0ZS5nYW1lLnRpbWUubm93XG4gICAgaWYgKG5vdyA8IHRoaXMuc3RhdGUuYnVsbGV0VGltZSkgcmV0dXJuXG4gICAgdGhpcy5zdGF0ZS5idWxsZXRUaW1lID0gbm93ICsgQ29uc3RhbnRQbGF5ZXIuZmlyZVJhdGVcbiAgICBjb25zdCBidWxsZXQgPSBidWxsZXRzLmdldEZpcnN0RXhpc3RzKGZhbHNlKVxuICAgIGlmICghYnVsbGV0KSByZXR1cm5cbiAgICBidWxsZXQucmVzZXQodGhpcy5zcHJpdGUueCwgdGhpcy5zcHJpdGUueSlcbiAgICBidWxsZXQuYm9keS52ZWxvY2l0eS5yb3RhdGUoMCwgMCwgdGhpcy5zcHJpdGUuYW5nbGUsIENvbnN0YW50UGxheWVyLmZpcmVBc0RlZ3JlZXMsIENvbnN0YW50UGxheWVyLmZpcmVWZWxvY2l0eSlcbiAgfVxufSIsIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCJsaWJzL3BoYXNlci9waGFzZXIuZC50c1wiIC8+XG5cbmltcG9ydCBDb25zdGFudEVuZW15IGZyb20gXCIuL2NvbnN0YW50cy9lbmVteVwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCbG9jayB7XG4gIHB1YmxpYyBzcHJpdGU6IFBoYXNlci5TcHJpdGVcbiAgcHJpdmF0ZSBzdGF0ZTogYW55ID0ge31cbiAgY29uc3RydWN0b3Ioc3ByaXRlOiBQaGFzZXIuU3ByaXRlKSB7XG4gICAgdGhpcy5zcHJpdGUgPSBzcHJpdGVcbiAgICB0aGlzLnNwcml0ZS5nYW1lLnBoeXNpY3MuZW5hYmxlKHRoaXMuc3ByaXRlLCBQaGFzZXIuUGh5c2ljcy5BUkNBREUpXG4gICAgdGhpcy5zcHJpdGUuYW5jaG9yLnNldCgwLjUpXG4gICAgLy8g5Zu65a6a44GZ44KLXG4gICAgdGhpcy5zcHJpdGUuYm9keS5pbW1vdmFibGUgPSB0cnVlXG4gICAgLy8g44Oe44OD44OX5aSW44G444Gu5YuV5L2cXG4gICAgdGhpcy5zcHJpdGUuYm9keS5jb2xsaWRlV29ybGRCb3VuZHMgPSB0cnVlXG4gICAgLy8gYm91bmNl6Kit5a6aXG4gICAgdGhpcy5zcHJpdGUuYm9keS5ib3VuY2Uuc2V0VG8oMCwgMClcblxuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBoZWFsdGg6IDxudW1iZXI+IENvbnN0YW50RW5lbXkuaGVhbHRoLFxuICAgICAgYWxpdmU6IDxib29sZWFuPiB0cnVlXG4gICAgfVxuICB9XG5cbiAgZGFtYWdlKCkge1xuICAgIHRoaXMuc3RhdGUuaGVhbHRoIC09IDFcblxuICAgIGlmICh0aGlzLnN0YXRlLmhlYWx0aCA+IDApXG4gICAge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuXG4gICAgdGhpcy5zdGF0ZS5hbGl2ZSA9IGZhbHNlXG4gICAgdGhpcy5zcHJpdGUua2lsbCgpXG4gICAgY29uc29sZS5sb2coJ2tpbGwhIScpXG5cbiAgICByZXR1cm4gdHJ1ZVxuICB9XG59XG4iLCIvLy8gPHJlZmVyZW5jZSBwYXRoPVwibGlicy9waGFzZXIvcGhhc2VyLmQudHNcIiAvPlxuXG5pbXBvcnQgQ29uc3RhbnRFbmVteSBmcm9tIFwiLi9jb25zdGFudHMvZW5lbXlcIlxuaW1wb3J0IFBsYXllciBmcm9tIFwiLi9wbGF5ZXJcIlxuaW1wb3J0IEJsb2NrIGZyb20gXCIuL2Jsb2NrXCJcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQnVpbGQgZXh0ZW5kcyBQaGFzZXIuU3RhdGUge1xuICBwcml2YXRlIHVuaXQ6IFBsYXllclxuICBwcml2YXRlIGVuZW1pZXM6IGFueSA9IFtdXG4gIHByaXZhdGUgYnVsbGV0czogUGhhc2VyLkdyb3VwXG4gIHByaXZhdGUgaW5wdXRLZXlzOiBhbnkgPSB7fVxuXG4gIHByZWxvYWQoKSB7XG4gIH1cblxuICBjcmVhdGUoKSB7XG4gICAgdGhpcy53b3JsZC5zZXRCb3VuZHMoMCwgMCwgdGhpcy5nYW1lLndpZHRoLCB0aGlzLmdhbWUuaGVpZ2h0KVxuXG4gICAgLy8gQ3JlYXRlIFBsYXllclxuICAgIGNvbnN0IHNwcml0ZVVuaXQgPSB0aGlzLmdhbWUuYWRkLnNwcml0ZSgwLCAwLCAndW5pdCcpXG4gICAgdGhpcy51bml0ID0gbmV3IFBsYXllcihzcHJpdGVVbml0KVxuXG4gICAgLy8gQ3JlYXRlIEVuZW1pZXNcbiAgICBsZXQgZW5lbXlDb3VudCA9IENvbnN0YW50RW5lbXkubnVtVG90YWxcbiAgICB3aGlsZSAoZW5lbXlDb3VudCA+IDApIHtcbiAgICAgIGNvbnN0IHNwcml0ZUJsb2NrID0gdGhpcy5nYW1lLmFkZC5zcHJpdGUodGhpcy53b3JsZC5yYW5kb21YLCB0aGlzLndvcmxkLnJhbmRvbVksICd1bmRlZmluZWQnKVxuICAgICAgY29uc3QgYmxvY2sgPSBuZXcgQmxvY2soc3ByaXRlQmxvY2spXG4gICAgICB0aGlzLmVuZW1pZXMucHVzaChibG9jay5zcHJpdGUpXG4gICAgICBlbmVteUNvdW50LS1cbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgQnVsbGV0c1xuICAgIHRoaXMuYnVsbGV0cyA9IHRoaXMuZ2FtZS5hZGQuZ3JvdXAoKVxuICAgIHRoaXMuYnVsbGV0cy5lbmFibGVCb2R5ID0gdHJ1ZVxuICAgIHRoaXMuYnVsbGV0cy5waHlzaWNzQm9keVR5cGUgPSBQaGFzZXIuUGh5c2ljcy5BUkNBREVcbiAgICB0aGlzLmJ1bGxldHMuY3JlYXRlTXVsdGlwbGUoMywgJ2J1bGxldCcsIDAsIGZhbHNlKVxuICAgIHRoaXMuYnVsbGV0cy5zZXRBbGwoJ2FuY2hvci54JywgMC41KVxuICAgIHRoaXMuYnVsbGV0cy5zZXRBbGwoJ2FuY2hvci55JywgMC41KVxuICAgIHRoaXMuYnVsbGV0cy5zZXRBbGwoJ291dE9mQm91bmRzS2lsbCcsIHRydWUpXG4gICAgdGhpcy5idWxsZXRzLnNldEFsbCgnY2hlY2tXb3JsZEJvdW5kcycsIHRydWUpXG5cbiAgICAvLyBUT0RPOiDooZ3nqoHjga7liKTlrppcblxuICAgIC8vIFRoZSBLZXlib2FyZCBJbnB1dCBtYW5hZ2VyLlxuICAgIC8vIENyZWF0ZXMgYW5kIHJldHVybnMgYW4gb2JqZWN0IGNvbnRhaW5pbmcgNCBob3RrZXlzIGZvciBVcCwgRG93biwgTGVmdCBhbmQgUmlnaHQuXG4gICAgdGhpcy5pbnB1dEtleXMuY3Vyc29ycyA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5jcmVhdGVDdXJzb3JLZXlzKClcbiAgICB0aGlzLmlucHV0S2V5cy5zcGFjZWJhciA9IHRoaXMuZ2FtZS5pbnB1dC5rZXlib2FyZC5hZGRLZXkoUGhhc2VyLktleWJvYXJkLlNQQUNFQkFSKVxuXG4gICAgLy8gIFN0b3AgdGhlIGZvbGxvd2luZyBrZXlzIGZyb20gcHJvcGFnYXRpbmcgdXAgdG8gdGhlIGJyb3dzZXJcbiAgICB0aGlzLmdhbWUuaW5wdXQua2V5Ym9hcmQuYWRkS2V5Q2FwdHVyZShbUGhhc2VyLktleWJvYXJkLlNQQUNFQkFSXSlcbiAgfVxuXG4gIHVwZGF0ZSgpIHtcbiAgICAvLyDlt6bml4vlm55cbiAgICBpZiAodGhpcy5pbnB1dEtleXMuY3Vyc29ycy5sZWZ0LmlzRG93bikge1xuICAgICAgdGhpcy51bml0LnJvdGF0ZUxlZnQoKVxuICAgIH1cblxuICAgIC8vIOW3puaXi+WbnlxuICAgIGlmICh0aGlzLmlucHV0S2V5cy5jdXJzb3JzLnJpZ2h0LmlzRG93bikge1xuICAgICAgdGhpcy51bml0LnJvdGF0ZVJpZ2h0KClcbiAgICB9XG5cbiAgICAvLyDliY3pgLJcbiAgICBpZiAodGhpcy5pbnB1dEtleXMuY3Vyc29ycy51cC5pc0Rvd24pIHtcbiAgICAgIHRoaXMudW5pdC5nb0Zyb250KClcbiAgICB9XG5cbiAgICAvLyDlvozpgLJcbiAgICBpZiAodGhpcy5pbnB1dEtleXMuY3Vyc29ycy5kb3duLmlzRG93bikge1xuICAgICAgdGhpcy51bml0LmdvQmFjaygpXG4gICAgfVxuXG4gICAgLy8gU2hvb3RcbiAgICBpZiAodGhpcy5pbnB1dEtleXMuc3BhY2ViYXIuaXNEb3duKSB7XG4gICAgICB0aGlzLnVuaXQuZmlyZSh0aGlzLmJ1bGxldHMpXG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgR2FtZSBmcm9tIFwiLi9nYW1lXCJcblxud2luZG93Lm9ubG9hZCA9ICgpID0+IHtcbiAgY29uc3QgZ2FtZSA9IG5ldyBHYW1lKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpXG59IiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cImxpYnMvcGhhc2VyL3BoYXNlci5kLnRzXCIgLz5cblxuaW1wb3J0IEJvb3QgZnJvbSBcIi4vYm9vdFwiXG5pbXBvcnQgUHJlbG9hZGVyIGZyb20gXCIuL3ByZWxvYWRlclwiXG5pbXBvcnQgQnVpbGQgZnJvbSBcIi4vYnVpbGRcIlxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lIGV4dGVuZHMgUGhhc2VyLkdhbWUge1xuICBwcml2YXRlIHNpemU6IGFueSA9IHt9XG4gIGNvbnN0cnVjdG9yKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKSB7XG4gICAgc3VwZXIod2lkdGgsIGhlaWdodCwgUGhhc2VyLkFVVE8sICdmaWVsZCcsIG51bGwpXG5cbiAgICB0aGlzLnN0YXRlLmFkZCgnQm9vdCcsIEJvb3QsIGZhbHNlKVxuICAgIHRoaXMuc3RhdGUuYWRkKCdQcmVsb2FkZXInLCBQcmVsb2FkZXIsIGZhbHNlKVxuICAgIHRoaXMuc3RhdGUuYWRkKCdCdWlsZCcsIEJ1aWxkLCBmYWxzZSlcblxuICAgIHRoaXMuc3RhdGUuc3RhcnQoJ0Jvb3QnKVxuICB9XG59Il0sInNvdXJjZVJvb3QiOiIifQ==